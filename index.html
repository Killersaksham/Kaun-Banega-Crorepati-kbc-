<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KBC Web</title>
  <style>
    body {
      background: url("image/bg.jpg") no-repeat center center fixed;
      background-size: cover;
      font-family: Georgia, serif;
      color: red;
      text-align: center;
      padding-top: 80px;
    }
    .option { margin: 15px; font-size: 20px; padding: 10px 20px; }
    .lifelines button { margin: 10px; font-size: 18px; padding: 8px 16px; }
    #timer, #prize { display: block; margin: 20px; font-size: 24px; }
  </style>
</head>
<body>
  <h1 id="question">Loading...</h1>
  <div id="options"></div>
  <div class="lifelines">
    <button onclick="use5050()">ðŸ§® 50-50</button>
    <button onclick="usePhone()">ðŸ“ž Phone a Friend</button>
  </div>
  <span id="timer">30</span>
  <span id="prize">Prize: â‚¹0</span>

  <audio id="audio-player" src=""></audio>

  <script>
    let current = 0, correctAnswer = "", used5050 = false, usedPhone = false;

    function playSound(file) {
      const player = document.getElementById("audio-player");
      player.src = "sounds/" + file;
      player.play();
    }

    function loadQuestion() {
      fetch("/get_question/" + current)
        .then(res => res.json())
        .then(data => {
          if (data.end) {
            alert("ðŸŽ‰ You completed the quiz!");
            return;
          }
          document.getElementById("question").innerText = data.question;
          correctAnswer = data.answer;
          document.getElementById("prize").innerText = "Prize: " + data.prize;
          document.getElementById("options").innerHTML = data.options.map(opt =>
            `<button class="option" onclick="checkAnswer('${opt}', this)">${opt}</button>`
          ).join("");
        });
    }

    function checkAnswer(answer, btn) {
      if (answer === correctAnswer) {
        btn.style.backgroundColor = "green";
        playSound("Correct.mp3");
        current++;
        setTimeout(loadQuestion, 1500);
      } else {
        btn.style.backgroundColor = "red";
        playSound("Wrong.mp3");
        alert("âŒ Wrong answer. Game Over.");
      }
    }

    function use5050() {
      if (used5050) return alert("Already used 50-50.");
      used5050 = true;
      let buttons = document.querySelectorAll(".option");
      let removed = 0;
      buttons.forEach(btn => {
        if (btn.innerText !== correctAnswer && removed < 2) {
          btn.innerText = "";
          btn.disabled = true;
          removed++;
        }
      });
    }

    function usePhone() {
      if (usedPhone) return alert("Already used Phone a Friend.");
      usedPhone = true;
      playSound("phoneafriend.mp3");
      fetch("/get_question/" + current)
        .then(res => res.json())
        .then(data => alert(data.suggestion));
    }

    window.onload = () => {
      playSound("theme.mp3");
      loadQuestion();
    };
  </script>
</body>
</html>
